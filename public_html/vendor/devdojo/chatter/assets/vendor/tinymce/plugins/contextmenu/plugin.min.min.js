tinymce.PluginManager.add("contextmenu",function(e){var d,f=e.settings.contextmenu_never_use_native;e.on("contextmenu",function(l){var k,j=e.getDoc();if(!l.ctrlKey||f){if(l.preventDefault(),tinymce.Env.mac&&tinymce.Env.webkit&&2==l.button&&j.caretRangeFromPoint&&e.selection.setRng(j.caretRangeFromPoint(l.x,l.y)),k=e.settings.contextmenu||"link image inserttable | cell row column deletetable",d){d.show()}else{var c=[];tinymce.each(k.split(/[ ,]/),function(g){var h=e.menuItems[g];"|"==g&&(h={text:g}),h&&(h.shortcut="",c.push(h))});for(var b=0;b<c.length;b++){"|"==c[b].text&&(0!==b&&b!=c.length-1||c.splice(b,1))}d=new tinymce.ui.Menu({items:c,context:"contextmenu",classes:"contextmenu"}).renderTo(),e.on("remove",function(){d.remove(),d=null})}var a={x:l.pageX,y:l.pageY};e.inline||(a=tinymce.DOM.getPos(e.getContentAreaContainer()),a.x+=l.clientX,a.y+=l.clientY),d.moveTo(a.x,a.y)}})});