(function(d){function c(g,f){var e=this;this.$element=d(g);this.options=d.extend(true,{},c.defaults,f);this._items=d();Object.defineProperties(this,{itemsSelector:{get:function(){return e.options.classMap.hasSubMenu+","+e.options.classMap.hasMegaMenu}},_tempChain:{value:null,writable:true},state:{value:null,writable:true}});this.initialize()}c.defaults={event:"hover",direction:"horizontal",breakpoint:991,animationIn:false,animationOut:false,rtl:false,hideTimeOut:300,sideBarRatio:1/4,pageContainer:d("body"),classMap:{initialized:".hs-menu-initialized",mobileState:".hs-mobile-state",subMenu:".hs-sub-menu",hasSubMenu:".hs-has-sub-menu",hasSubMenuActive:".hs-sub-menu-opened",megaMenu:".hs-mega-menu",hasMegaMenu:".hs-has-mega-menu",hasMegaMenuActive:".hs-mega-menu-opened"},mobileSpeed:400,mobileEasing:"linear",beforeOpen:function(){},beforeClose:function(){},afterOpen:function(){},afterClose:function(){}};c.prototype.initialize=function(){var e=this,f=d(window);if(this.options.rtl){this.$element.addClass("hs-rtl")}this.$element.addClass(this.options.classMap.initialized.slice(1)).addClass("hs-menu-"+this.options.direction);f.on("resize.HSMegaMenu",function(g){if(e.resizeTimeOutId){clearTimeout(e.resizeTimeOutId)}e.resizeTimeOutId=setTimeout(function(){if(f.width()<=e.options.breakpoint&&e.state=="desktop"){e.initMobileBehavior()}else{if(f.width()>e.options.breakpoint&&e.state=="mobile"){e.initDesktopBehavior()}}e.refresh()},50)});d(document).on("click.HSMegaMenu",function(h){var g=d(h.target).parents(e.itemsSelector);e.closeAll(g.add(d(h.target)))}).on("keyup.HSMegaMenu",function(g){if(g.keyCode&&g.keyCode==27){e.closeAll()}});if(f.width()<=this.options.breakpoint){this.initMobileBehavior()}else{if(f.width()>this.options.breakpoint){this.initDesktopBehavior()}}this.smartPositions();return this};c.prototype.smartPositions=function(){var e=this,f=this.$element.find(this.options.classMap.subMenu);f.each(function(g,h){b.smartPosition(d(h),e.options)})};c.prototype.bindEvents=function(){var f=this,e;if(this.options.event==="hover"&&!a()){this.$element.on("mouseenter.HSMegaMenu",this.options.classMap.hasMegaMenu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(i){var h=d(this),g=h.parents(f.itemsSelector);if(!h.data("HSMenuItem")){f.initMenuItem(h,f.getType(h))}g=g.add(h);f.closeAll(g);g.each(function(j,k){var l=d(k).data("HSMenuItem");if(l.hideTimeOutId){clearTimeout(l.hideTimeOutId)}l.show()});f._items=f._items.not(g);f._tempChain=g;i.preventDefault();i.stopPropagation()}).on("mouseleave.HSMegaMenu",this.options.classMap.hasMegaMenu+':not([data-event="click"]),'+this.options.classMap.hasSubMenu+':not([data-event="click"])',function(i){var h=d(this),j=h.data("HSMenuItem"),g=d(i.relatedTarget).parents(f.itemsSelector);j.hideTimeOutId=setTimeout(function(){f.closeAll(g)},f.options.hideTimeOut);f._items=f._items.add(f._tempChain);f._tempChain=null;i.preventDefault();i.stopPropagation()}).on("click.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="click"] > a, '+this.options.classMap.hasSubMenu+'[data-event="click"] > a',function(h){var g=d(this).parent('[data-event="click"]'),i;if(!g.data("HSMenuItem")){f.initMenuItem(g,f.getType(g))}f.closeAll(g.add(g.parents(f.itemsSelector)));i=g.data("HSMenuItem");if(i.isOpened){i.hide()}else{i.show()}h.preventDefault();h.stopPropagation()})}else{this.$element.on("click.HSMegaMenu",(a()?this.options.classMap.hasMegaMenu+" > a, "+this.options.classMap.hasSubMenu+" > a":this.options.classMap.hasMegaMenu+':not([data-event="hover"]) > a,'+this.options.classMap.hasSubMenu+':not([data-event="hover"]) > a'),function(i){var h=d(this).parent(),j,g=h.parents(f.itemsSelector);if(!h.data("HSMenuItem")){f.initMenuItem(h,f.getType(h))}f.closeAll(h.add(h.parents(f.itemsSelector)));j=h.addClass("hs-event-prevented").data("HSMenuItem");if(j.isOpened){j.hide()}else{j.show()}i.preventDefault();i.stopPropagation()});if(!a()){this.$element.on("mouseenter.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(i){var h=d(this),g=h.parents(f.itemsSelector);if(!h.data("HSMenuItem")){f.initMenuItem(h,f.getType(h))}f.closeAll(h.add(g));g.add(h).each(function(j,k){var l=d(k).data("HSMenuItem");if(l.hideTimeOutId){clearTimeout(l.hideTimeOutId)}l.show()});i.preventDefault();i.stopPropagation()}).on("mouseleave.HSMegaMenu",this.options.classMap.hasMegaMenu+'[data-event="hover"],'+this.options.classMap.hasSubMenu+'[data-event="hover"]',function(h){var g=d(this),i=g.data("HSMenuItem");i.hideTimeOutId=setTimeout(function(){f.closeAll(d(h.relatedTarget).parents(f.itemsSelector))},f.options.hideTimeOut);h.preventDefault();h.stopPropagation()})}}};c.prototype.initMenuItem=function(g,h){var e=this,f=new b(g,g.children(e.options.classMap[h==="mega-menu"?"megaMenu":"subMenu"]),d.extend(true,{type:h},e.options,g.data()),e.$element);g.data("HSMenuItem",f);this._items=this._items.add(g)};c.prototype.initMobileBehavior=function(){var e=this;this.state="mobile";this.$element.off(".HSMegaMenu").addClass(this.options.classMap.mobileState.slice(1)).on("click.HSMegaMenu",e.options.classMap.hasSubMenu+" > a, "+e.options.classMap.hasMegaMenu+" > a",function(h){var g=d(this).parent(),f;if(!g.data("HSMenuItem")){e.initMenuItem(g,e.getType(g))}e.closeAll(g.parents(e.itemsSelector).add(g));f=g.data("HSMenuItem");console.log(f.isOpened);if(f.isOpened){f.mobileHide()}else{f.mobileShow()}h.preventDefault();h.stopPropagation()}).find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+","+this.options.classMap.hasMegaMenuActive).children(this.options.classMap.subMenu+","+this.options.classMap.megaMenu).hide()};c.prototype.initDesktopBehavior=function(){this.state="desktop";this.$element.removeClass(this.options.classMap.mobileState.slice(1)).off(".HSMegaMenu").find(this.itemsSelector).not(this.options.classMap.hasSubMenuActive+","+this.options.classMap.hasMegaMenuActive).children(this.options.classMap.subMenu+","+this.options.classMap.megaMenu).hide();this.bindEvents()};c.prototype.closeAll=function(f){var e=this;return this._items.not(f&&f.length?f:d()).each(function(g,h){d(h).removeClass("hs-event-prevented").data("HSMenuItem")[e.state=="mobile"?"mobileHide":"hide"]()})};c.prototype.getType=function(e){if(!e||!e.length){return null}return e.hasClass(this.options.classMap.hasSubMenu.slice(1))?"sub-menu":(e.hasClass(this.options.classMap.hasMegaMenu.slice(1))?"mega-menu":null)};c.prototype.getState=function(){return this.state};c.prototype.refresh=function(){return this._items.add(this._tempChain).each(function(e,f){d(f).data("HSMenuItem")._updateMenuBounds()})};function b(h,i,g,e){var f=this;this.$element=h;this.menu=i;this.options=g;this.$container=e;Object.defineProperties(this,{itemClass:{get:function(){return f.options.type==="mega-menu"?f.options.classMap.hasMegaMenu:f.options.classMap.hasSubMenu}},activeItemClass:{get:function(){return f.options.type==="mega-menu"?f.options.classMap.hasMegaMenuActive:f.options.classMap.hasSubMenuActive}},menuClass:{get:function(){return f.options.type==="mega-menu"?f.options.classMap.megaMenu:f.options.classMap.subMenu}},isOpened:{get:function(){return this.$element.hasClass(this.activeItemClass.slice(1))}}});this.menu.addClass("animated").on("click.HSMegaMenu",function(j){f._updateMenuBounds()});if(this.$element.data("max-width")){this.menu.css("max-width",this.$element.data("max-width"))}if(this.$element.data("position")){this.menu.addClass("hs-position-"+this.$element.data("position"))}if(this.options.animationOut){this.menu.on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(j){if(f.menu.hasClass(f.options.animationOut)){f.$element.removeClass(f.activeItemClass.slice(1));f.options.afterClose.call(f,f.$element,f.menu)}if(f.menu.hasClass(f.options.animationIn)){f.options.afterOpen.call(f,f.$element,f.menu)}j.stopPropagation();j.preventDefault()})}}b.prototype.show=function(){if(!this.menu.length){return this}this.$element.addClass(this.activeItemClass.slice(1));if(this.options.direction=="horizontal"){this.smartPosition(this.menu,this.options)}this._updateMenuBounds();if(this.options.animationOut){this.menu.removeClass(this.options.animationOut)}else{this.options.afterOpen.call(this,this.$element,this.menu)}if(this.options.animationIn){this.menu.addClass(this.options.animationIn)}return this};b.prototype.hide=function(){var e=this;if(!this.menu.length){return this}if(!this.options.animationOut){this.$element.removeClass(this.activeItemClass.slice(1))}if(this.options.animationIn){this.menu.removeClass(this.options.animationIn)}if(this.options.animationOut){this.menu.addClass(this.options.animationOut)}else{this.options.afterClose.call(this,this.$element,this.menu)}return this};b.prototype.mobileShow=function(){var e=this;if(!this.menu.length){return this}this.menu.removeClass(this.options.animationIn).removeClass(this.options.animationOut).stop().slideDown({duration:e.options.mobileSpeed,easing:e.options.mobileEasing,complete:function(){e.options.afterOpen.call(e,e.$element,e.menu)}});this.$element.addClass(this.activeItemClass.slice(1));return this};b.prototype.mobileHide=function(){var e=this;if(!this.menu.length){return this}this.menu.stop().slideUp({duration:e.options.mobileSpeed,easing:e.options.mobileEasing,complete:function(){e.options.afterClose.call(e,e.$element,e.menu)}});this.$element.removeClass(this.activeItemClass.slice(1));return this};b.prototype.smartPosition=function(f,e){b.smartPosition(f,e)};b.smartPosition=function(f,e){if(!f&&!f.length){return}var g=d(window);f.removeClass("hs-reversed");if(!e.rtl){if(f.offset().left+f.outerWidth()>g.width()){f.addClass("hs-reversed")}}else{if(f.offset().left<0){f.addClass("hs-reversed")}}};b.prototype._updateMenuBounds=function(){var e="auto";if(this.options.direction=="vertical"&&this.options.type=="mega-menu"){if(this.$container&&this.$container.data("HSMegaMenu").getState()=="desktop"){if(!this.options.pageContainer.length){this.options.pageContainer=d("body")}e=this.options.pageContainer.outerWidth()*(1-this.options.sideBarRatio)}else{e="auto"}this.menu.css({width:e,height:"auto"});if(this.menu.outerHeight()>this.$container.outerHeight()){return}this.menu.css("height","100%")}};d.fn.HSMegaMenu=function(e){return this.each(function(f,g){var h=d(this);if(!h.data("HSMegaMenu")){h.data("HSMegaMenu",new c(h,e))}})};function a(){return("ontouchstart" in window)}})(jQuery);